# Face Tracking  

Суть проекта заключается в разработке модели, которая будет распознавать лица на изображении. Данная модель пригодится мне в дальнейшем для других проектов.

## Требования: 
1. Модель должна быстро работать и мало весить (в дальнейшем предполагается использование на Raspberry pi).  
2. Есть всего два класса — background и лицо. Модель должна детектировать лица с достаточной точностью (вблизи должна распознавать их околоидеально).  
3. Т.к. распознаваться на изображении будут лица, то применять нужно модель, которая распознаёт именно маленькие объекты.  
4. По размерам обнаруженных объектов должен находиться самый маленький из них.  
5. Программа должна рассчитывать расстояние от центра изображения до центра каждого из объектов.  
6. Потенциально нужно будет сделать трекинг.

## План работы:  
- ~~1-ый день. Подготовить проект к началу работы — гит-репозиторий, докер и т.п.~~  
- ~~2-ой день. Определиться с используемой моделью, а также с разрешением фото. Подобрать датасет для transfer-learning, подобрать инструмент для разметки этого датасета (для детектирования).~~  
- 3-ий и 4-ый день. Дообучить модель, протестировать её на своей выборке.  
- 5-ый день. Добавить расчёт расстояния от центра изображения до каждого объекта. Добавить сортировку по величине. Добавить какую-нибудь подсветку, когда центр изображения попадает внутрь рамки объекта (не обязательно в центр объекта).  

В будущем:  
Добавить трекинг  
Добавить Raspberry pi, купить к нему камеру, поставить нейронку на микроконтроллер.

## Ход работы:
1. Гит-репозиторий и докер-файл подготовил, тут ничего особенного.
2. Т.к. нужна быстрая модель с приемлемым качеством детектирования, выбор стоял между какой-нибудь компактной версией YOLO и SSDLite. 
Для YOLO у Ultralytics есть подробное руководство по использованию с Raspberry pi, 
а также соответствующие бенчмарки. Для SSDLite есть различные инструкции и статьи по работе с Raspberry pi, 
но они выглядят более хаотично. Поэтому предварительно была выбрана YOLO. 
Разрешение изображения, как оказалось, не принципиально (я ранее думал, что есть какие-то ограничения, 
связанные с камерой, но там все камеры могут делать снимки и записывать видео в достаточно высоком разрешении). 
Разрешение выбрано 640x640. В качестве тренировочных датасетов предварительно отобрал: 
- https://www.kaggle.com/datasets/dataturks/face-detection-in-images/data. 
Для разметки объектов на фото можно использовать https://www.robots.ox.ac.uk/~vgg/software/via/via.html.